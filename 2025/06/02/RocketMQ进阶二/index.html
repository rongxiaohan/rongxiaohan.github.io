

<!DOCTYPE html>
<html lang="zh-Hans" color-mode=light>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>RocketMQè¿›é˜¶äºŒ - ç¬‘å®¹+</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="google" content="notranslate" />
  <meta name="keywords" content="æŠ€æœ¯åšå®¢, Java, Python, Node.js, Web å¼€å‘">
  <meta name="description" content="
RocketMQå»¶è¿Ÿæ¶ˆæ¯ä¸æ‰¹é‡æ¶ˆæ¯ğŸ•’ ä¸€ã€å»¶è¿Ÿæ¶ˆæ¯...">
  <meta name="author" content="å•çº¿ç¨‹åƒåœ¾æ¸…ç†å·¥">
  <link rel="icon" href="/images/icons/favicon-16x16.png" type="image/png" sizes="16x16">
  <link rel="icon" href="/images/icons/favicon-32x32.png" type="image/png" sizes="32x32">
  <link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png" sizes="180x180">
  <meta rel="mask-icon" href="/images/icons/stun-logo.svg" color="#333333">
  
    <meta rel="msapplication-TileImage" content="/images/icons/favicon-144x144.png">
    <meta rel="msapplication-TileColor" content="#000000">
  

  
<link rel="stylesheet" href="/css/style.css">


  
    
<link rel="stylesheet" href="https://at.alicdn.com/t/font_1445822_p6ry5n7lrr.css">

  

  
    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css">

  

  
    
      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/solarized-dark.min.css" name="highlight-style" mode="light">

      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/solarized-dark.min.css" name="highlight-style" mode="dark">

      
  

  <script>
    var CONFIG = window.CONFIG || {};
    var ZHAOO = window.ZHAOO || {};
    CONFIG = {
      isHome: false,
      fancybox: true,
      pjax: false,
      loading: {
        gif: '/images/theme/loading.gif',
        lottie: ''
      },
      lazyload: {
        enable: true,
        only_post: 'false',
        loading: {
          gif: '/images/theme/loading.gif',
          lottie: ''
        }
      },
      donate: {
        enable: false,
        alipay: 'https://pic.izhaoo.com/alipay.jpg',
        wechat: 'https://pic.izhaoo.com/wechat.jpg'
      },
      galleries: {
        enable: true
      },
      fab: {
        enable: true,
        always_show: false
      },
      carrier: {
        enable: true
      },
      daovoice: {
        enable: false
      },
      preview: {
        background: {
          default: '',
          api: ''
        },
        motto: {
          default: 'æˆ‘åœ¨å¼€äº†ç¯çš„åºŠå¤´ä¸‹ï¼Œæƒ³é—®é—®è‡ªå·±çš„å¿ƒå•Šã€‚',
          typing: true,
          api: 'https://v2.jinrishici.com/one.json',
          data_contents: '["data","content"]'
        },
      },
      qrcode: {
        enable: true,
        type: 'url',
        image: 'https://pic.izhaoo.com/weapp-code.jpg',
      },
      toc: {
        enable: true
      },
      scrollbar: {
        type: 'simple'
      },
      notification: {
        enable: false,
        delay: 4500,
        list: '',
        page_white_list: '',
        page_black_list: ''
      },
      search: {
        enable: false,
        path: ''
      }
    }
  </script>

  

  

<meta name="generator" content="Hexo 7.3.0"></head>

<body class="lock-screen">
  <div class="loading" id="loading"></div>
  
    


  <nav class="navbar">
    <div class="left">
      
        <i class="iconfont iconhome j-navbar-back-home"></i>
      
      
        <i class="iconfont iconqrcode j-navbar-qrcode"></i>
      
      
        <i class="iconfont iconmoono" id="color-toggle" color-toggle="light"></i>
      
      
    </div>
    <div class="center">RocketMQè¿›é˜¶äºŒ</div>
    <div class="right">
      <i class="iconfont iconmenu j-navbar-menu"></i>
    </div>
    
      <div id="qrcode-navbar"></div>
    
  </nav>

  
  

<nav class="menu">
  <div class="menu-container">
    <div class="menu-close">
      <i class="iconfont iconbaseline-close-px"></i>
    </div>
    <ul class="menu-content"><li class="menu-item">
        <a href="/ " class="underline "> é¦–é¡µ</a>
      </li><li class="menu-item">
        <a href="/galleries/ " class="underline "> ç”Ÿæ´»</a>
      </li><li class="menu-item">
        <a href="/archives/ " class="underline "> å½’æ¡£</a>
      </li><li class="menu-item">
        <a href="/tags/ " class="underline "> æ ‡ç­¾</a>
      </li><li class="menu-item">
        <a href="/categories/ " class="underline "> åˆ†ç±»</a>
      </li><li class="menu-item">
        <a href="/about/ " class="underline "> å…³äº</a>
      </li></ul>
    
      <div class="menu-copyright"><p></p></div>
    
  </div>
</nav>
  <main id="main">
  <div class="article-wrap">
    <div class="row container">
      <div class="col-xl-3"></div>
      <div class="col-xl-6"><article class="article">
  <div class="wrap">
    <section class="head">
  <img   class="lazyload" data-original="/images/theme/post-image.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  draggable="false">
  <div class="head-mask">
    <h1 class="head-title">RocketMQè¿›é˜¶äºŒ</h1>
    <div class="head-info">
      <span class="post-info-item"><i class="iconfont iconcalendar"></i>June 02, 2025</span>
      
      <span class="post-info-item"><i class="iconfont iconfont-size"></i>9512</span>
    </div>
  </div>
</section>
    <section class="main">
      <section class="content">
        
        <hr>
<h1 id="RocketMQå»¶è¿Ÿæ¶ˆæ¯ä¸æ‰¹é‡æ¶ˆæ¯"><a href="#RocketMQå»¶è¿Ÿæ¶ˆæ¯ä¸æ‰¹é‡æ¶ˆæ¯" class="headerlink" title="RocketMQå»¶è¿Ÿæ¶ˆæ¯ä¸æ‰¹é‡æ¶ˆæ¯"></a><strong>RocketMQå»¶è¿Ÿæ¶ˆæ¯ä¸æ‰¹é‡æ¶ˆæ¯</strong></h1><h2 id="ğŸ•’-ä¸€ã€å»¶è¿Ÿæ¶ˆæ¯ï¼ˆå®šæ—¶æ¶ˆæ¯ï¼‰"><a href="#ğŸ•’-ä¸€ã€å»¶è¿Ÿæ¶ˆæ¯ï¼ˆå®šæ—¶æ¶ˆæ¯ï¼‰" class="headerlink" title="ğŸ•’ ä¸€ã€å»¶è¿Ÿæ¶ˆæ¯ï¼ˆå®šæ—¶æ¶ˆæ¯ï¼‰"></a>ğŸ•’ ä¸€ã€å»¶è¿Ÿæ¶ˆæ¯ï¼ˆå®šæ—¶æ¶ˆæ¯ï¼‰</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>RocketMQ ä½¿ç”¨ <strong>é¢„å®šä¹‰çš„å»¶è¿Ÿç­‰çº§</strong> å®ç°å»¶è¿Ÿæ¶ˆæ¯ï¼ˆéä»»æ„æ—¶é—´å»¶è¿Ÿï¼‰ï¼Œæ¯ä¸ªç­‰çº§å¯¹åº”ä¸€ä¸ªå›ºå®šçš„å»¶è¿Ÿæ—¶é—´ã€‚</p>
<h3 id="ğŸš€-å»¶è¿Ÿç­‰çº§ï¼ˆé»˜è®¤ï¼‰"><a href="#ğŸš€-å»¶è¿Ÿç­‰çº§ï¼ˆé»˜è®¤ï¼‰" class="headerlink" title="ğŸš€ å»¶è¿Ÿç­‰çº§ï¼ˆé»˜è®¤ï¼‰"></a>ğŸš€ å»¶è¿Ÿç­‰çº§ï¼ˆé»˜è®¤ï¼‰</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs text">1: 1s<br>2: 5s<br>3: 10s<br>4: 30s<br>5: 1m<br>6: 2m<br>7: 3m<br>8: 4m<br>9: 5m<br>...<br>18: 2h<br></code></pre></td></tr></table></figure>

<h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul>
<li><p>åªèƒ½ä½¿ç”¨é¢„å®šä¹‰ç­‰çº§ï¼Œæ— æ³•è‡ªå®šä¹‰ä»»æ„æ—¶é—´ã€‚</p>
</li>
<li><p>ä»…æ”¯æŒ <strong><code>DelayTimeLevel</code></strong> é…ç½®ï¼Œä¸æ”¯æŒæ¶ˆè´¹è€…ç«¯å»¶è¿Ÿæ¶ˆè´¹ã€‚</p>
</li>
</ul>
<h3 id="âœ-ç¤ºä¾‹ä»£ç "><a href="#âœ-ç¤ºä¾‹ä»£ç " class="headerlink" title="âœ ç¤ºä¾‹ä»£ç "></a>âœ ç¤ºä¾‹ä»£ç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>(<span class="hljs-string">&quot;TopicTest&quot;</span>, <span class="hljs-string">&quot;TagA&quot;</span>, <span class="hljs-string">&quot;OrderID001&quot;</span>, <span class="hljs-string">&quot;Hello delay!&quot;</span>.getBytes());<br>msg.setDelayTimeLevel(<span class="hljs-number">3</span>); <span class="hljs-comment">// å»¶è¿Ÿ10ç§’</span><br>producer.send(msg);<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="äºŒã€æ‰¹é‡æ¶ˆæ¯ï¼ˆBatch-Messageï¼‰"><a href="#äºŒã€æ‰¹é‡æ¶ˆæ¯ï¼ˆBatch-Messageï¼‰" class="headerlink" title="äºŒã€æ‰¹é‡æ¶ˆæ¯ï¼ˆBatch Messageï¼‰"></a>äºŒã€æ‰¹é‡æ¶ˆæ¯ï¼ˆBatch Messageï¼‰</h2><h3 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>å°†å¤šä¸ªæ¶ˆæ¯æ‰“åŒ…ä¸ºä¸€æ‰¹ï¼Œä¸€æ¬¡æ€§å‘é€ï¼Œæé«˜ååé‡ã€‚</p>
<h3 id="ğŸš«-é™åˆ¶"><a href="#ğŸš«-é™åˆ¶" class="headerlink" title="ğŸš« é™åˆ¶"></a>ğŸš« é™åˆ¶</h3><ul>
<li><p>æ‰¹æ¬¡æ€»å¤§å°ä¸èƒ½è¶…è¿‡ 4MBã€‚</p>
</li>
<li><p>åŒä¸€æ‰¹æ¶ˆæ¯éœ€æœ‰ç›¸åŒçš„ Topicã€ç›¸åŒçš„ waitStoreMsgOK æ ‡å¿—ã€‚</p>
</li>
<li><p>ä¸æ”¯æŒå»¶è¿Ÿæ¶ˆæ¯ï¼ˆæ‰¹é‡æ¶ˆæ¯ä¸èƒ½è®¾ç½® <code>DelayTimeLevel</code>ï¼‰ã€‚</p>
</li>
</ul>
<h3 id="âœ-ç¤ºä¾‹ä»£ç -1"><a href="#âœ-ç¤ºä¾‹ä»£ç -1" class="headerlink" title="âœ ç¤ºä¾‹ä»£ç "></a>âœ ç¤ºä¾‹ä»£ç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;Message&gt; messages = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>messages.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>(<span class="hljs-string">&quot;TopicTest&quot;</span>, <span class="hljs-string">&quot;TagA&quot;</span>, <span class="hljs-string">&quot;key1&quot;</span>, <span class="hljs-string">&quot;Hello 1&quot;</span>.getBytes()));<br>messages.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>(<span class="hljs-string">&quot;TopicTest&quot;</span>, <span class="hljs-string">&quot;TagA&quot;</span>, <span class="hljs-string">&quot;key2&quot;</span>, <span class="hljs-string">&quot;Hello 2&quot;</span>.getBytes()));<br>messages.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>(<span class="hljs-string">&quot;TopicTest&quot;</span>, <span class="hljs-string">&quot;TagA&quot;</span>, <span class="hljs-string">&quot;key3&quot;</span>, <span class="hljs-string">&quot;Hello 3&quot;</span>.getBytes()));<br>producer.send(messages);<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ¤”-å»¶è¿Ÿæ¶ˆæ¯-vs-æ‰¹é‡æ¶ˆæ¯"><a href="#ğŸ¤”-å»¶è¿Ÿæ¶ˆæ¯-vs-æ‰¹é‡æ¶ˆæ¯" class="headerlink" title="ğŸ¤” å»¶è¿Ÿæ¶ˆæ¯ vs æ‰¹é‡æ¶ˆæ¯"></a>ğŸ¤” å»¶è¿Ÿæ¶ˆæ¯ vs æ‰¹é‡æ¶ˆæ¯</h2><table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>å»¶è¿Ÿæ¶ˆæ¯</th>
<th>æ‰¹é‡æ¶ˆæ¯</th>
</tr>
</thead>
<tbody><tr>
<td>ç›®çš„</td>
<td>å»¶æ—¶æŠ•é€’ï¼ˆå®šæ—¶æ‰§è¡Œï¼‰</td>
<td>æå‡ååï¼ˆæ‰¹é‡ä¼ è¾“ï¼‰</td>
</tr>
<tr>
<td>æ˜¯å¦æ”¯æŒä»»æ„æ—¶é—´</td>
<td>âŒï¼ˆåªèƒ½é€‰ç­‰çº§ï¼‰</td>
<td>âŒ</td>
</tr>
<tr>
<td>æ˜¯å¦æ”¯æŒå¼‚æ­¥</td>
<td></td>
<td></td>
</tr>
<tr>
<td>æ˜¯å¦æ”¯æŒäº‹åŠ¡æ¶ˆæ¯</td>
<td></td>
<td>âŒ</td>
</tr>
<tr>
<td>æ¶ˆæ¯å¤§å°é™åˆ¶</td>
<td>4MB</td>
<td>æ¯æ‰¹ â‰¤ 4MB</td>
</tr>
<tr>
<td>æ˜¯å¦æ”¯æŒæ··åˆä½¿ç”¨</td>
<td>âŒï¼ˆæ‰¹é‡æ¶ˆæ¯ä¸èƒ½å»¶è¿Ÿï¼‰</td>
<td>âŒ</td>
</tr>
</tbody></table>
<h1 id="RocketMQäº‹åŠ¡æ¶ˆæ¯æœºåˆ¶"><a href="#RocketMQäº‹åŠ¡æ¶ˆæ¯æœºåˆ¶" class="headerlink" title="RocketMQäº‹åŠ¡æ¶ˆæ¯æœºåˆ¶"></a><strong>RocketMQäº‹åŠ¡æ¶ˆæ¯æœºåˆ¶</strong></h1><hr>
<h2 id="ä¸€ã€äº‹åŠ¡æ¶ˆæ¯æ ¸å¿ƒåŸç†"><a href="#ä¸€ã€äº‹åŠ¡æ¶ˆæ¯æ ¸å¿ƒåŸç†" class="headerlink" title="ä¸€ã€äº‹åŠ¡æ¶ˆæ¯æ ¸å¿ƒåŸç†"></a>ä¸€ã€äº‹åŠ¡æ¶ˆæ¯æ ¸å¿ƒåŸç†</h2><p>RocketMQ çš„äº‹åŠ¡æ¶ˆæ¯åˆ† <strong>ä¸¤ä¸ªé˜¶æ®µ</strong>ï¼š</p>
<h3 id="1ï¸âƒ£-åŠæ¶ˆæ¯ï¼ˆHalf-Messageï¼‰"><a href="#1ï¸âƒ£-åŠæ¶ˆæ¯ï¼ˆHalf-Messageï¼‰" class="headerlink" title="1ï¸âƒ£ åŠæ¶ˆæ¯ï¼ˆHalf Messageï¼‰"></a>1ï¸âƒ£ åŠæ¶ˆæ¯ï¼ˆHalf Messageï¼‰</h3><ul>
<li><p>Producer å‘é€çš„æ˜¯ä¸€ä¸ª <strong>â€œæš‚ä¸å¯è§â€çš„åŠæ¶ˆæ¯</strong>ã€‚</p>
</li>
<li><p>æ¶ˆæ¯è¿›å…¥ RocketMQï¼Œä¸ä¼šè¢«æ¶ˆè´¹è€…æ¶ˆè´¹ã€‚</p>
</li>
</ul>
<h3 id="2ï¸âƒ£-æ‰§è¡Œæœ¬åœ°äº‹åŠ¡"><a href="#2ï¸âƒ£-æ‰§è¡Œæœ¬åœ°äº‹åŠ¡" class="headerlink" title="2ï¸âƒ£ æ‰§è¡Œæœ¬åœ°äº‹åŠ¡"></a>2ï¸âƒ£ æ‰§è¡Œæœ¬åœ°äº‹åŠ¡</h3><ul>
<li>Producer æ¥ç€æ‰§è¡Œæœ¬åœ°äº‹åŠ¡é€»è¾‘ï¼ˆå¦‚æ•°æ®åº“æ“ä½œï¼‰ã€‚</li>
</ul>
<h3 id="3ï¸âƒ£-æ ¹æ®æœ¬åœ°äº‹åŠ¡ç»“æœå‘ŠçŸ¥-MQï¼š"><a href="#3ï¸âƒ£-æ ¹æ®æœ¬åœ°äº‹åŠ¡ç»“æœå‘ŠçŸ¥-MQï¼š" class="headerlink" title="3ï¸âƒ£ æ ¹æ®æœ¬åœ°äº‹åŠ¡ç»“æœå‘ŠçŸ¥ MQï¼š"></a>3ï¸âƒ£ æ ¹æ®æœ¬åœ°äº‹åŠ¡ç»“æœå‘ŠçŸ¥ MQï¼š</h3><ul>
<li><p>æäº¤äº‹åŠ¡ï¼ˆ<code>COMMIT</code>ï¼‰ï¼šæ¶ˆæ¯å˜ä¸ºå¯æŠ•é€’çŠ¶æ€ã€‚</p>
</li>
<li><p>å›æ»šäº‹åŠ¡ï¼ˆ<code>ROLLBACK</code>ï¼‰ï¼šæ¶ˆæ¯è¢«ä¸¢å¼ƒã€‚</p>
</li>
<li><p>çŠ¶æ€ä¸ç¡®å®šï¼ˆ<code>UNKNOWN</code>ï¼‰ï¼šMQ è¿‡ä¸€æ®µæ—¶é—´ä¼šå›æŸ¥ã€‚</p>
</li>
</ul>
<hr>
<h2 id="äºŒã€RocketMQ-çš„äº‹åŠ¡çŠ¶æ€å›æŸ¥æœºåˆ¶"><a href="#äºŒã€RocketMQ-çš„äº‹åŠ¡çŠ¶æ€å›æŸ¥æœºåˆ¶" class="headerlink" title="äºŒã€RocketMQ çš„äº‹åŠ¡çŠ¶æ€å›æŸ¥æœºåˆ¶"></a>äºŒã€RocketMQ çš„äº‹åŠ¡çŠ¶æ€å›æŸ¥æœºåˆ¶</h2><p>å½“ Producer è¿”å› <code>UNKNOWN</code> æˆ–ç½‘ç»œä¸­æ–­ï¼ŒBroker ä¼š <strong>å®šæœŸå›æŸ¥äº‹åŠ¡çŠ¶æ€</strong>ï¼š</p>
<ul>
<li><p>å›è°ƒ Producer çš„ <code>checkLocalTransaction</code> æ–¹æ³•ï¼Œç¡®è®¤äº‹åŠ¡çš„çœŸå®çŠ¶æ€ã€‚</p>
</li>
<li><p>Producer å¿…é¡»å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œæ ¹æ®ä¸šåŠ¡æ ‡è¯†æŸ¥æ•°æ®åº“ç­‰æ–¹å¼è¿”å›çœŸå®çŠ¶æ€ã€‚</p>
</li>
</ul>
<hr>
<h2 id="ğŸ—ï¸-ä¸‰ã€å…³é”®ç±»-æ–¹æ³•"><a href="#ğŸ—ï¸-ä¸‰ã€å…³é”®ç±»-æ–¹æ³•" class="headerlink" title="ğŸ—ï¸ ä¸‰ã€å…³é”®ç±» &amp; æ–¹æ³•"></a>ğŸ—ï¸ ä¸‰ã€å…³é”®ç±» &amp; æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åˆ›å»ºæ”¯æŒäº‹åŠ¡çš„ Producer</span><br><span class="hljs-type">TransactionMQProducer</span> <span class="hljs-variable">producer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransactionMQProducer</span>(<span class="hljs-string">&quot;tx_producer_group&quot;</span>);<br><br><span class="hljs-comment">// è®¾ç½®æœ¬åœ°äº‹åŠ¡ç›‘å¬å™¨</span><br>producer.setTransactionListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TransactionListener</span>() &#123;<br>    <span class="hljs-comment">// æ‰§è¡Œæœ¬åœ°äº‹åŠ¡</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> LocalTransactionState <span class="hljs-title function_">executeLocalTransaction</span><span class="hljs-params">(Message msg, Object arg)</span> &#123;<br>        <span class="hljs-comment">// 1. æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ï¼Œå¦‚å†™æ•°æ®åº“</span><br>        <span class="hljs-comment">// 2. æ ¹æ®ç»“æœè¿”å› COMMIT / ROLLBACK / UNKNOWN</span><br>    &#125;<br><br>    <span class="hljs-comment">// å›æŸ¥æœ¬åœ°äº‹åŠ¡çŠ¶æ€</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> LocalTransactionState <span class="hljs-title function_">checkLocalTransaction</span><span class="hljs-params">(MessageExt msg)</span> &#123;<br>        <span class="hljs-comment">// ä¾‹å¦‚æ ¹æ® msg ä¸­çš„ä¸šåŠ¡Key å»æŸ¥æ•°æ®åº“çŠ¶æ€</span><br>        <span class="hljs-comment">// è¿”å› COMMIT / ROLLBACK</span><br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="å››ã€å®Œæ•´ç¤ºä¾‹"><a href="#å››ã€å®Œæ•´ç¤ºä¾‹" class="headerlink" title="å››ã€å®Œæ•´ç¤ºä¾‹"></a>å››ã€å®Œæ•´ç¤ºä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>(<span class="hljs-string">&quot;TxTopic&quot;</span>, <span class="hljs-string">&quot;tagA&quot;</span>, <span class="hljs-string">&quot;key123&quot;</span>, <span class="hljs-string">&quot;Hello Transaction&quot;</span>.getBytes());<br><br><span class="hljs-comment">// å‘é€äº‹åŠ¡æ¶ˆæ¯ï¼ˆå‘é€åŠæ¶ˆæ¯ + å›è°ƒäº‹åŠ¡æ‰§è¡Œï¼‰</span><br><span class="hljs-type">TransactionSendResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> producer.sendMessageInTransaction(msg, yourBusinessArg);<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="äº”ã€äº‹åŠ¡çŠ¶æ€æšä¸¾è¯´æ˜"><a href="#äº”ã€äº‹åŠ¡çŠ¶æ€æšä¸¾è¯´æ˜" class="headerlink" title="äº”ã€äº‹åŠ¡çŠ¶æ€æšä¸¾è¯´æ˜"></a>äº”ã€äº‹åŠ¡çŠ¶æ€æšä¸¾è¯´æ˜</h2><table>
<thead>
<tr>
<th>çŠ¶æ€</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>COMMIT_MESSAGE</code></td>
<td>äº‹åŠ¡æˆåŠŸï¼Œæ¶ˆæ¯æŠ•é€’</td>
</tr>
<tr>
<td><code>ROLLBACK_MESSAGE</code></td>
<td>äº‹åŠ¡å¤±è´¥ï¼Œæ¶ˆæ¯ä¸¢å¼ƒ</td>
</tr>
<tr>
<td><code>UNKNOW</code></td>
<td>çŠ¶æ€ä¸æ˜ï¼ŒBroker åç»­ä¼šå›æŸ¥</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸš§-å…­ã€æ³¨æ„äº‹é¡¹"><a href="#ğŸš§-å…­ã€æ³¨æ„äº‹é¡¹" class="headerlink" title="ğŸš§ å…­ã€æ³¨æ„äº‹é¡¹"></a>ğŸš§ å…­ã€æ³¨æ„äº‹é¡¹</h2><ul>
<li><p><strong>äº‹åŠ¡æ¶ˆæ¯ä¸æ”¯æŒå»¶è¿Ÿæ¶ˆæ¯ã€æ‰¹é‡æ¶ˆæ¯ã€‚</strong></p>
</li>
<li><p><strong>äº‹åŠ¡Producer å¿…é¡»é•¿æ—¶é—´è¿è¡Œï¼ŒBrokeréœ€è¦èƒ½å›æŸ¥äº‹åŠ¡çŠ¶æ€ã€‚</strong></p>
</li>
<li><p>æœ€å¥½ä½¿ç”¨ä¸šåŠ¡ä¸»é”®ç­‰æ ‡è¯†å­˜åœ¨ DB ä¸­ï¼Œä¾¿äºå›æŸ¥äº‹åŠ¡çŠ¶æ€ã€‚</p>
</li>
<li><p>è‹¥æœ¬åœ°äº‹åŠ¡å¤±è´¥ï¼Œè®°å¾—æ˜ç¡®è¿”å› <code>ROLLBACK</code>ï¼Œå¦åˆ™ MQ ä¼šæŒç»­å›æŸ¥ã€‚</p>
</li>
</ul>
<h1 id="RocketMQ-ACLæƒé™æ§åˆ¶ä½“ç³»"><a href="#RocketMQ-ACLæƒé™æ§åˆ¶ä½“ç³»" class="headerlink" title="RocketMQ ACLæƒé™æ§åˆ¶ä½“ç³»"></a><strong>RocketMQ ACLæƒé™æ§åˆ¶ä½“ç³»</strong></h1><hr>
<h2 id="ğŸ”-ä¸€ã€ACL-æƒé™æ§åˆ¶æ¦‚è§ˆ"><a href="#ğŸ”-ä¸€ã€ACL-æƒé™æ§åˆ¶æ¦‚è§ˆ" class="headerlink" title="ğŸ” ä¸€ã€ACL æƒé™æ§åˆ¶æ¦‚è§ˆ"></a>ğŸ” ä¸€ã€ACL æƒé™æ§åˆ¶æ¦‚è§ˆ</h2><p>RocketMQ çš„ ACL é‡‡ç”¨ <strong>åŸºäºç”¨æˆ·èº«ä»½å’Œ Topic çº§åˆ«çš„æƒé™æ§åˆ¶</strong>ï¼Œæ”¯æŒï¼š</p>
<table>
<thead>
<tr>
<th>æ§åˆ¶é¡¹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>èº«ä»½è®¤è¯</strong></td>
<td>ä½¿ç”¨ AccessKey &#x2F; SecretKey é‰´æƒ</td>
</tr>
<tr>
<td><strong>æ“ä½œæƒé™</strong></td>
<td>å‘å¸ƒï¼ˆPUBï¼‰ã€è®¢é˜…ï¼ˆSUBï¼‰æƒé™æ§åˆ¶</td>
</tr>
<tr>
<td><strong>èµ„æºæ§åˆ¶</strong></td>
<td>å¯ç²¾ç»†åˆ°æ¯ä¸ª Topicã€ConsumerGroup</td>
</tr>
</tbody></table>
<hr>
<h2 id="äºŒã€æ ¸å¿ƒæœºåˆ¶ç»„æˆ"><a href="#äºŒã€æ ¸å¿ƒæœºåˆ¶ç»„æˆ" class="headerlink" title="äºŒã€æ ¸å¿ƒæœºåˆ¶ç»„æˆ"></a>äºŒã€æ ¸å¿ƒæœºåˆ¶ç»„æˆ</h2><h3 id="1ï¸âƒ£-é‰´æƒæ–¹å¼ï¼šAccessKey-SecretKey"><a href="#1ï¸âƒ£-é‰´æƒæ–¹å¼ï¼šAccessKey-SecretKey" class="headerlink" title="1ï¸âƒ£ é‰´æƒæ–¹å¼ï¼šAccessKey &amp; SecretKey"></a>1ï¸âƒ£ é‰´æƒæ–¹å¼ï¼šAccessKey &amp; SecretKey</h3><p>ç±»ä¼¼äº AWS IAMï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-comment"># ç¤ºä¾‹é…ç½®</span><br><span class="hljs-attr">accessKey</span>=admin<br><span class="hljs-attr">secretKey</span>=<span class="hljs-number">12345678</span><br></code></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯è¿æ¥ MQ æ—¶å¿…é¡»æä¾›æ­¤å‡­è¯ã€‚</p>
<hr>
<h3 id="2ï¸âƒ£-é…ç½®æ–‡ä»¶ï¼šplain-acl-yml"><a href="#2ï¸âƒ£-é…ç½®æ–‡ä»¶ï¼šplain-acl-yml" class="headerlink" title="2ï¸âƒ£ é…ç½®æ–‡ä»¶ï¼šplain_acl.yml"></a>2ï¸âƒ£ é…ç½®æ–‡ä»¶ï¼š<code>plain_acl.yml</code></h3><p>ACL é…ç½®ä½äº Broker èŠ‚ç‚¹çš„ <code>conf/plain_acl.yml</code> æ–‡ä»¶ä¸­ï¼Œé»˜è®¤è·¯å¾„ä¸ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$ROCKETMQ_HOME</span>/conf/plain_acl.yml<br></code></pre></td></tr></table></figure>

<p>ç¤ºä¾‹å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">globalWhiteRemoteAddresses:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br><br><span class="hljs-attr">accounts:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">accessKey:</span> <span class="hljs-string">admin</span><br>    <span class="hljs-attr">secretKey:</span> <span class="hljs-number">12345678</span><br>    <span class="hljs-attr">whiteRemoteAddress:</span> <span class="hljs-number">192.168</span><span class="hljs-string">.*.*</span><br>    <span class="hljs-attr">admin:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">defaultTopicPerm:</span> <span class="hljs-string">DENY</span><br>    <span class="hljs-attr">defaultGroupPerm:</span> <span class="hljs-string">SUB</span><br>    <span class="hljs-attr">topicPerms:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">topicA=PUB|SUB</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">topicB=DENY</span><br>    <span class="hljs-attr">groupPerms:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">groupA=SUB</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="ä¸‰ã€æƒé™æ§åˆ¶ç²’åº¦"><a href="#ä¸‰ã€æƒé™æ§åˆ¶ç²’åº¦" class="headerlink" title="ä¸‰ã€æƒé™æ§åˆ¶ç²’åº¦"></a>ä¸‰ã€æƒé™æ§åˆ¶ç²’åº¦</h2><table>
<thead>
<tr>
<th>æ§åˆ¶é¡¹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>defaultTopicPerm</code></td>
<td>å¯¹æ‰€æœ‰ Topic çš„é»˜è®¤æƒé™ï¼ˆPUB&#x2F;SUB&#x2F;DENYï¼‰</td>
</tr>
<tr>
<td><code>topicPerms</code></td>
<td>é’ˆå¯¹æŒ‡å®š Topic çš„ç²¾ç¡®æƒé™</td>
</tr>
<tr>
<td><code>groupPerms</code></td>
<td>é’ˆå¯¹ ConsumerGroup çš„è®¢é˜…æƒé™</td>
</tr>
<tr>
<td><code>whiteRemoteAddress</code></td>
<td>ç™½åå• IPï¼Œå¯è·³è¿‡è®¤è¯</td>
</tr>
<tr>
<td><code>admin</code></td>
<td>æ˜¯å¦æ‹¥æœ‰ç®¡ç†å‘˜æƒé™ï¼ˆèƒ½ç®¡ç† Topic&#x2F;Groupï¼‰</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸ”§-å››ã€å¼€å¯-ACL-çš„æ­¥éª¤"><a href="#ğŸ”§-å››ã€å¼€å¯-ACL-çš„æ­¥éª¤" class="headerlink" title="ğŸ”§ å››ã€å¼€å¯ ACL çš„æ­¥éª¤"></a>ğŸ”§ å››ã€å¼€å¯ ACL çš„æ­¥éª¤</h2><ol>
<li><strong>å¯ç”¨ ACL æƒé™æ§åˆ¶</strong></li>
</ol>
<p>ä¿®æ”¹ <code>broker.conf</code> åŠ å…¥ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">aclEnable</span>=<span class="hljs-string">true</span><br></code></pre></td></tr></table></figure>

<ol start="2">
<li><strong>åŠ è½½é…ç½®æ–‡ä»¶</strong></li>
</ol>
<p>ç¡®ä¿ <code>plain_acl.yml</code> æ”¾åœ¨ <code>$ROCKETMQ_HOME/conf</code> ä¸‹ï¼Œæˆ–è‡ªå®šä¹‰è·¯å¾„ï¼Œå¹¶åœ¨ <code>broker.conf</code> ä¸­æŒ‡å®šï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">aclAccessConfig</span>=<span class="hljs-string">conf/plain_acl.yml</span><br></code></pre></td></tr></table></figure>

<ol start="3">
<li><strong>é‡å¯ Broker</strong></li>
</ol>
<hr>
<h2 id="ğŸ‘¨â€ğŸ’»-äº”ã€å®¢æˆ·ç«¯æ¥å…¥é…ç½®ï¼ˆJava-ç¤ºä¾‹ï¼‰"><a href="#ğŸ‘¨â€ğŸ’»-äº”ã€å®¢æˆ·ç«¯æ¥å…¥é…ç½®ï¼ˆJava-ç¤ºä¾‹ï¼‰" class="headerlink" title="ğŸ‘¨â€ğŸ’» äº”ã€å®¢æˆ·ç«¯æ¥å…¥é…ç½®ï¼ˆJava ç¤ºä¾‹ï¼‰"></a>ğŸ‘¨â€ğŸ’» äº”ã€å®¢æˆ·ç«¯æ¥å…¥é…ç½®ï¼ˆJava ç¤ºä¾‹ï¼‰</h2><p>æ·»åŠ  <code>AccessChannel</code> é…ç½®ï¼Œè®¾ç½® <code>SessionCredentialsProvider</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">ClientConfig</span> <span class="hljs-variable">clientConfig</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClientConfig</span>();<br>clientConfig.setAccessChannel(AccessChannel.CLOUD);<br><br><span class="hljs-type">SessionCredentials</span> <span class="hljs-variable">credentials</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SessionCredentials</span>(<span class="hljs-string">&quot;admin&quot;</span>, <span class="hljs-string">&quot;12345678&quot;</span>);<br><br><span class="hljs-type">MQProducer</span> <span class="hljs-variable">producer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultMQProducer</span>(<span class="hljs-string">&quot;ProducerGroup&quot;</span>, <br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">AclClientRPCHook</span>(credentials), <span class="hljs-literal">true</span>);<br>producer.setNamesrvAddr(<span class="hljs-string">&quot;127.0.0.1:9876&quot;</span>);<br>producer.start();<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ§ª-å…­ã€æ³¨æ„äº‹é¡¹"><a href="#ğŸ§ª-å…­ã€æ³¨æ„äº‹é¡¹" class="headerlink" title="ğŸ§ª å…­ã€æ³¨æ„äº‹é¡¹"></a>ğŸ§ª å…­ã€æ³¨æ„äº‹é¡¹</h2><ul>
<li><p><strong>ACL å¼€å¯åæ‰€æœ‰å®¢æˆ·ç«¯éƒ½å¿…é¡»é‰´æƒ</strong>ï¼Œå¦åˆ™æŠ¥é”™ï¼š</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">CODE: 308 DESC: No permission for this operation<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>ACL æ˜¯ Broker çº§åˆ«ç”Ÿæ•ˆçš„</strong>ï¼Œéœ€æ‰€æœ‰ Broker èŠ‚ç‚¹å¼€å¯ã€‚</p>
</li>
<li><p>å¦‚æœä½ ä½¿ç”¨ Spring Boot + RocketMQï¼Œéœ€åœ¨é…ç½®ä¸­æ˜¾å¼è®¾ç½® AccessKey å’Œ SecretKeyã€‚</p>
</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">rocketmq:</span><br>  <span class="hljs-attr">producer:</span><br>    <span class="hljs-attr">access-key:</span> <span class="hljs-string">admin</span><br>    <span class="hljs-attr">secret-key:</span> <span class="hljs-number">12345678</span><br></code></pre></td></tr></table></figure>

<h1 id="SpringBootæ•´åˆRocketMQ"><a href="#SpringBootæ•´åˆRocketMQ" class="headerlink" title="SpringBootæ•´åˆRocketMQ"></a><strong>SpringBootæ•´åˆRocketMQ</strong></h1><hr>
<h2 id="ä¸€ã€å¼•å…¥ä¾èµ–ï¼ˆä»¥-Apache-å®˜æ–¹ç‰ˆæœ¬ä¸ºå‡†ï¼‰"><a href="#ä¸€ã€å¼•å…¥ä¾èµ–ï¼ˆä»¥-Apache-å®˜æ–¹ç‰ˆæœ¬ä¸ºå‡†ï¼‰" class="headerlink" title="ä¸€ã€å¼•å…¥ä¾èµ–ï¼ˆä»¥ Apache å®˜æ–¹ç‰ˆæœ¬ä¸ºå‡†ï¼‰"></a>ä¸€ã€å¼•å…¥ä¾èµ–ï¼ˆä»¥ Apache å®˜æ–¹ç‰ˆæœ¬ä¸ºå‡†ï¼‰</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.rocketmq<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>rocketmq-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span> <span class="hljs-comment">&lt;!-- å¯¹åº” RocketMQ 4.9.x æˆ– 5.x --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="äºŒã€é…ç½®-application-yml"><a href="#äºŒã€é…ç½®-application-yml" class="headerlink" title="äºŒã€é…ç½® application.yml"></a>äºŒã€é…ç½® application.yml</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">rocketmq:</span><br>  <span class="hljs-attr">name-server:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:9876</span><br>  <span class="hljs-attr">producer:</span><br>    <span class="hljs-attr">group:</span> <span class="hljs-string">my-producer-group</span><br>    <span class="hljs-attr">send-message-timeout:</span> <span class="hljs-number">3000</span><br>    <span class="hljs-attr">access-key:</span> <span class="hljs-string">admin</span>  <span class="hljs-comment"># å¦‚æœå¯ç”¨äº† ACL</span><br>    <span class="hljs-attr">secret-key:</span> <span class="hljs-number">12345678</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸš€-ä¸‰ã€æ¶ˆæ¯ç”Ÿäº§è€…ç¤ºä¾‹"><a href="#ğŸš€-ä¸‰ã€æ¶ˆæ¯ç”Ÿäº§è€…ç¤ºä¾‹" class="headerlink" title="ğŸš€ ä¸‰ã€æ¶ˆæ¯ç”Ÿäº§è€…ç¤ºä¾‹"></a>ğŸš€ ä¸‰ã€æ¶ˆæ¯ç”Ÿäº§è€…ç¤ºä¾‹</h2><h3 id="æ™®é€šæ¶ˆæ¯å‘é€"><a href="#æ™®é€šæ¶ˆæ¯å‘é€" class="headerlink" title="æ™®é€šæ¶ˆæ¯å‘é€"></a>æ™®é€šæ¶ˆæ¯å‘é€</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyProducer</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RocketMQTemplate rocketMQTemplate;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendSimpleMessage</span><span class="hljs-params">()</span> &#123;<br>        rocketMQTemplate.convertAndSend(<span class="hljs-string">&quot;TestTopic&quot;</span>, <span class="hljs-string">&quot;Hello RocketMQ!&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="å¸¦-Tag-å’Œ-Key"><a href="#å¸¦-Tag-å’Œ-Key" class="headerlink" title="å¸¦ Tag å’Œ Key"></a>å¸¦ Tag å’Œ Key</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">rocketMQTemplate.syncSend(<span class="hljs-string">&quot;TestTopic:tagA&quot;</span>, <span class="hljs-string">&quot;message with tag&quot;</span>, <span class="hljs-number">3000</span>);<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“¥-å››ã€æ¶ˆæ¯æ¶ˆè´¹è€…ç¤ºä¾‹"><a href="#ğŸ“¥-å››ã€æ¶ˆæ¯æ¶ˆè´¹è€…ç¤ºä¾‹" class="headerlink" title="ğŸ“¥ å››ã€æ¶ˆæ¯æ¶ˆè´¹è€…ç¤ºä¾‹"></a>ğŸ“¥ å››ã€æ¶ˆæ¯æ¶ˆè´¹è€…ç¤ºä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-meta">@RocketMQMessageListener(</span><br><span class="hljs-meta">    topic = &quot;TestTopic&quot;,</span><br><span class="hljs-meta">    consumerGroup = &quot;my-consumer-group&quot;,</span><br><span class="hljs-meta">    selectorExpression = &quot;*&quot;</span><br><span class="hljs-meta">)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyConsumer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQListener</span>&lt;String&gt; &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String message)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æ”¶åˆ°æ¶ˆæ¯ï¼š&quot;</span> + message);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="äº”ã€äº‹åŠ¡æ¶ˆæ¯ï¼ˆäº‹åŠ¡å‹-Producerï¼‰"><a href="#äº”ã€äº‹åŠ¡æ¶ˆæ¯ï¼ˆäº‹åŠ¡å‹-Producerï¼‰" class="headerlink" title="äº”ã€äº‹åŠ¡æ¶ˆæ¯ï¼ˆäº‹åŠ¡å‹ Producerï¼‰"></a>äº”ã€äº‹åŠ¡æ¶ˆæ¯ï¼ˆäº‹åŠ¡å‹ Producerï¼‰</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TxProducer</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RocketMQTemplate rocketMQTemplate;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendTransactionMessage</span><span class="hljs-params">()</span> &#123;<br>        rocketMQTemplate.sendMessageInTransaction(<span class="hljs-string">&quot;TxTopic&quot;</span>, MessageBuilder.withPayload(<span class="hljs-string">&quot;äº‹åŠ¡æ¶ˆæ¯&quot;</span>).build(), <span class="hljs-literal">null</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="äº‹åŠ¡ç›‘å¬å™¨"><a href="#äº‹åŠ¡ç›‘å¬å™¨" class="headerlink" title="äº‹åŠ¡ç›‘å¬å™¨"></a>äº‹åŠ¡ç›‘å¬å™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RocketMQTransactionListener</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TxListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQLocalTransactionListener</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> RocketMQLocalTransactionState <span class="hljs-title function_">executeLocalTransaction</span><span class="hljs-params">(Message msg, Object arg)</span> &#123;<br>        <span class="hljs-comment">// æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ï¼Œä¾‹å¦‚æ•°æ®åº“å†™å…¥</span><br>        <span class="hljs-keyword">return</span> RocketMQLocalTransactionState.COMMIT;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> RocketMQLocalTransactionState <span class="hljs-title function_">checkLocalTransaction</span><span class="hljs-params">(Message msg)</span> &#123;<br>        <span class="hljs-comment">// å›æŸ¥äº‹åŠ¡çŠ¶æ€</span><br>        <span class="hljs-keyword">return</span> RocketMQLocalTransactionState.COMMIT;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ›¡ï¸-å…­ã€å¼€å¯-ACL-çš„è¯ï¼ˆéœ€è¦è®¾ç½®å‡­è¯ï¼‰"><a href="#ğŸ›¡ï¸-å…­ã€å¼€å¯-ACL-çš„è¯ï¼ˆéœ€è¦è®¾ç½®å‡­è¯ï¼‰" class="headerlink" title="ğŸ›¡ï¸ å…­ã€å¼€å¯ ACL çš„è¯ï¼ˆéœ€è¦è®¾ç½®å‡­è¯ï¼‰"></a>ğŸ›¡ï¸ å…­ã€å¼€å¯ ACL çš„è¯ï¼ˆéœ€è¦è®¾ç½®å‡­è¯ï¼‰</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">rocketmq:</span><br>  <span class="hljs-attr">producer:</span><br>    <span class="hljs-attr">access-key:</span> <span class="hljs-string">admin</span><br>    <span class="hljs-attr">secret-key:</span> <span class="hljs-number">12345678</span><br>  <span class="hljs-attr">consumer:</span><br>    <span class="hljs-attr">access-key:</span> <span class="hljs-string">admin</span><br>    <span class="hljs-attr">secret-key:</span> <span class="hljs-number">12345678</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ”-ä¸ƒã€å¸¸è§é—®é¢˜"><a href="#ğŸ”-ä¸ƒã€å¸¸è§é—®é¢˜" class="headerlink" title="ğŸ” ä¸ƒã€å¸¸è§é—®é¢˜"></a>ğŸ” ä¸ƒã€å¸¸è§é—®é¢˜</h2><table>
<thead>
<tr>
<th>é—®é¢˜</th>
<th>è§£å†³æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody><tr>
<td>æ‰¾ä¸åˆ° NameServer</td>
<td>æ£€æŸ¥é…ç½®å’Œç«¯å£ï¼Œé˜²ç«å¢™æ˜¯å¦æ‹¦æˆª</td>
</tr>
<tr>
<td>æ¶ˆè´¹æ— æ•ˆ</td>
<td>ç¡®è®¤ group åå”¯ä¸€ï¼Œtopic æ­£ç¡®ï¼Œæ¶ˆæ¯æœªè¢«è¿‡æ»¤</td>
</tr>
<tr>
<td>ACL æŠ¥é”™</td>
<td>æœªè®¾ç½® accessKey&#x2F;secretKey</td>
</tr>
<tr>
<td>Spring Boot 3+</td>
<td>éœ€è¦é…åˆ JakartaEE æ”¯æŒ RocketMQ 5.x</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸ-Bonusï¼šæœ€ä½³å®è·µå»ºè®®"><a href="#ğŸ-Bonusï¼šæœ€ä½³å®è·µå»ºè®®" class="headerlink" title="ğŸ Bonusï¼šæœ€ä½³å®è·µå»ºè®®"></a>ğŸ Bonusï¼šæœ€ä½³å®è·µå»ºè®®</h2><table>
<thead>
<tr>
<th>å»ºè®®</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody><tr>
<td>å‘é€æ¶ˆæ¯åŠ ä¸šåŠ¡ key</td>
<td>æ–¹ä¾¿è¿½è¸ªä¸å›æŸ¥äº‹åŠ¡</td>
</tr>
<tr>
<td>æ¶ˆè´¹ç»„å‘½åè§„èŒƒ</td>
<td>é˜²æ­¢ group å†²çª</td>
</tr>
<tr>
<td>ä½¿ç”¨ Spring Cloud Stream æ—¶å…³æ³¨å…¼å®¹æ€§</td>
<td>RocketMQ Binder é€‚é…ä¸åŒç‰ˆæœ¬</td>
</tr>
<tr>
<td>ç»“åˆæ—¥å¿—&#x2F;é“¾è·¯è¿½è¸ªï¼ˆå¦‚ Sleuthï¼‰</td>
<td>å¿«é€Ÿæ’æŸ¥åˆ†å¸ƒå¼æ¶ˆæ¯é—®é¢˜</td>
</tr>
</tbody></table>
<h1 id="RocketMQå®¢æˆ·ç«¯æ³¨æ„äº‹é¡¹"><a href="#RocketMQå®¢æˆ·ç«¯æ³¨æ„äº‹é¡¹" class="headerlink" title="RocketMQå®¢æˆ·ç«¯æ³¨æ„äº‹é¡¹"></a><strong>RocketMQå®¢æˆ·ç«¯æ³¨æ„äº‹é¡¹</strong></h1><hr>
<h2 id="ä¸€ã€å®¢æˆ·ç«¯é€šç”¨æ³¨æ„äº‹é¡¹"><a href="#ä¸€ã€å®¢æˆ·ç«¯é€šç”¨æ³¨æ„äº‹é¡¹" class="headerlink" title="ä¸€ã€å®¢æˆ·ç«¯é€šç”¨æ³¨æ„äº‹é¡¹"></a>ä¸€ã€å®¢æˆ·ç«¯é€šç”¨æ³¨æ„äº‹é¡¹</h2><table>
<thead>
<tr>
<th>âš  é¡¹</th>
<th>å»ºè®®è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>NameServer åœ°å€</td>
<td>ä½¿ç”¨ <strong>å¤šä¸ªåœ°å€</strong>ï¼ˆç”¨ <code>;</code> åˆ†éš”ï¼‰ï¼Œé¿å…å•ç‚¹æ•…éšœã€‚</td>
</tr>
<tr>
<td>å®¢æˆ·ç«¯å®ä¾‹</td>
<td><strong>ä¸€ä¸ªåº”ç”¨å»ºè®®å…±ç”¨ä¸€ä¸ª MQ å®ä¾‹</strong>ï¼ˆProducer&#x2F;Consumerï¼‰ï¼Œé¿å…çº¿ç¨‹èµ„æºæµªè´¹ã€‚</td>
</tr>
<tr>
<td>Group å</td>
<td>Producer å’Œ Consumer çš„ group <strong>å¿…é¡»å”¯ä¸€</strong>ï¼Œä¸è¦å¤šä¸ªåº”ç”¨å…±ç”¨åŒä¸€ groupã€‚</td>
</tr>
<tr>
<td>Topic åç§°</td>
<td>é¿å…ä½¿ç”¨â€œä¸‹åˆ’çº¿ + ç³»ç»Ÿå…³é”®å­—â€ç­‰æ•æ„Ÿå­—ç¬¦ï¼Œå°½é‡å°å†™å¹¶æœ‰ä¸šåŠ¡å‰ç¼€ã€‚</td>
</tr>
<tr>
<td>å¼‚æ­¥æ¶ˆæ¯</td>
<td>å¼‚æ­¥å‘é€æ¶ˆæ¯è®°å¾—è®¾ç½®å›è°ƒå¹¶åšå¥½å¼‚å¸¸æ•è·ã€‚</td>
</tr>
<tr>
<td>æ¶ˆæ¯å¤§å°</td>
<td>å•æ¡æ¶ˆæ¯é»˜è®¤ä¸Šé™ 4MBï¼Œå¤§äºéœ€å‹ç¼©æˆ–æ‹†åŒ…ã€‚</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸš€-äºŒã€Producer-æ³¨æ„äº‹é¡¹"><a href="#ğŸš€-äºŒã€Producer-æ³¨æ„äº‹é¡¹" class="headerlink" title="ğŸš€ äºŒã€Producer æ³¨æ„äº‹é¡¹"></a>ğŸš€ äºŒã€Producer æ³¨æ„äº‹é¡¹</h2><h3 id="æ­£ç¡®é…ç½®å‘é€é‡è¯•æœºåˆ¶"><a href="#æ­£ç¡®é…ç½®å‘é€é‡è¯•æœºåˆ¶" class="headerlink" title="æ­£ç¡®é…ç½®å‘é€é‡è¯•æœºåˆ¶"></a>æ­£ç¡®é…ç½®å‘é€é‡è¯•æœºåˆ¶</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">producer.setRetryTimesWhenSendFailed(<span class="hljs-number">3</span>);<br>producer.setRetryTimesWhenSendAsyncFailed(<span class="hljs-number">2</span>);<br></code></pre></td></tr></table></figure>

<h3 id="ä¿è¯-Producer-é•¿æ—¶é—´å­˜åœ¨ï¼ˆä¸èƒ½é¢‘ç¹åˆ›å»ºå’Œé”€æ¯ï¼‰"><a href="#ä¿è¯-Producer-é•¿æ—¶é—´å­˜åœ¨ï¼ˆä¸èƒ½é¢‘ç¹åˆ›å»ºå’Œé”€æ¯ï¼‰" class="headerlink" title="ä¿è¯ Producer é•¿æ—¶é—´å­˜åœ¨ï¼ˆä¸èƒ½é¢‘ç¹åˆ›å»ºå’Œé”€æ¯ï¼‰"></a>ä¿è¯ Producer é•¿æ—¶é—´å­˜åœ¨ï¼ˆä¸èƒ½é¢‘ç¹åˆ›å»ºå’Œé”€æ¯ï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å»ºè®®åœ¨åº”ç”¨å¯åŠ¨æ—¶åˆå§‹åŒ–ï¼Œå¸¸é©»å†…å­˜</span><br><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> DefaultMQProducer <span class="hljs-title function_">defaultMQProducer</span><span class="hljs-params">()</span> &#123; ... &#125;<br></code></pre></td></tr></table></figure>

<h3 id="å‘é€æ¶ˆæ¯å‰ä¸€å®šè¦-start"><a href="#å‘é€æ¶ˆæ¯å‰ä¸€å®šè¦-start" class="headerlink" title="å‘é€æ¶ˆæ¯å‰ä¸€å®šè¦ start"></a>å‘é€æ¶ˆæ¯å‰ä¸€å®šè¦ start</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">producer.start(); <span class="hljs-comment">// å¦åˆ™ç›´æ¥ NPE æˆ–æ— æç¤ºå¤±è´¥</span><br></code></pre></td></tr></table></figure>

<h3 id="å¼‚æ­¥æ¶ˆæ¯ä¸è¦åæ‰å¼‚å¸¸"><a href="#å¼‚æ­¥æ¶ˆæ¯ä¸è¦åæ‰å¼‚å¸¸" class="headerlink" title="å¼‚æ­¥æ¶ˆæ¯ä¸è¦åæ‰å¼‚å¸¸"></a>å¼‚æ­¥æ¶ˆæ¯ä¸è¦åæ‰å¼‚å¸¸</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">producer.send(message, <span class="hljs-keyword">new</span> <span class="hljs-title class_">SendCallback</span>() &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onSuccess</span><span class="hljs-params">(SendResult sendResult)</span> &#123; ... &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onException</span><span class="hljs-params">(Throwable e)</span> &#123;<br>        log.error(<span class="hljs-string">&quot;å‘é€å¤±è´¥&quot;</span>, e);<br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“¥-ä¸‰ã€Consumer-æ³¨æ„äº‹é¡¹"><a href="#ğŸ“¥-ä¸‰ã€Consumer-æ³¨æ„äº‹é¡¹" class="headerlink" title="ğŸ“¥ ä¸‰ã€Consumer æ³¨æ„äº‹é¡¹"></a>ğŸ“¥ ä¸‰ã€Consumer æ³¨æ„äº‹é¡¹</h2><h3 id="å¹‚ç­‰æ¶ˆè´¹ï¼"><a href="#å¹‚ç­‰æ¶ˆè´¹ï¼" class="headerlink" title="å¹‚ç­‰æ¶ˆè´¹ï¼"></a>å¹‚ç­‰æ¶ˆè´¹ï¼</h3><p>RocketMQ é»˜è®¤ <strong>â€œè‡³å°‘ä¸€æ¬¡æŠ•é€’â€</strong>ï¼Œæ‰€ä»¥æ¶ˆè´¹è€…å¿…é¡»æ”¯æŒå¹‚ç­‰é€»è¾‘ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ¶ˆè´¹æ¶ˆæ¯å‰æŸ¥æ•°æ®åº“çŠ¶æ€</span><br><span class="hljs-keyword">if</span> (å·²å¤„ç†è¿‡è¯¥æ¶ˆæ¯çš„å”¯ä¸€Key) &#123;<br>    <span class="hljs-keyword">return</span>; <span class="hljs-comment">// é˜²é‡å¤æ¶ˆè´¹</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="è®¾ç½®çº¿ç¨‹æ± å‚æ•°"><a href="#è®¾ç½®çº¿ç¨‹æ± å‚æ•°" class="headerlink" title="è®¾ç½®çº¿ç¨‹æ± å‚æ•°"></a>è®¾ç½®çº¿ç¨‹æ± å‚æ•°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">consumer.setConsumeThreadMin(<span class="hljs-number">10</span>);<br>consumer.setConsumeThreadMax(<span class="hljs-number">50</span>);<br></code></pre></td></tr></table></figure>

<h3 id="æ¶ˆè´¹æ¨¡å¼é€‰æ‹©ï¼šé›†ç¾¤-vs-å¹¿æ’­"><a href="#æ¶ˆè´¹æ¨¡å¼é€‰æ‹©ï¼šé›†ç¾¤-vs-å¹¿æ’­" class="headerlink" title="æ¶ˆè´¹æ¨¡å¼é€‰æ‹©ï¼šé›†ç¾¤ vs å¹¿æ’­"></a>æ¶ˆè´¹æ¨¡å¼é€‰æ‹©ï¼šé›†ç¾¤ vs å¹¿æ’­</h3><table>
<thead>
<tr>
<th>æ¨¡å¼</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody><tr>
<td>é›†ç¾¤æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰</td>
<td>å¤šå®ä¾‹è´Ÿè½½å‡è¡¡æ¶ˆè´¹</td>
</tr>
<tr>
<td>å¹¿æ’­æ¨¡å¼</td>
<td>æ¯ä¸ªå®ä¾‹éƒ½æ¶ˆè´¹ä¸€æ¬¡ï¼ˆå¦‚ï¼šæ—¥å¿—ã€å‘Šè­¦ï¼‰</td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">consumer.setMessageModel(MessageModel.BROADCASTING);<br></code></pre></td></tr></table></figure>

<h3 id="æ‰‹åŠ¨-ACK-å¤±è´¥é‡è¯•é€»è¾‘"><a href="#æ‰‹åŠ¨-ACK-å¤±è´¥é‡è¯•é€»è¾‘" class="headerlink" title="æ‰‹åŠ¨ ACK å¤±è´¥é‡è¯•é€»è¾‘"></a>æ‰‹åŠ¨ ACK å¤±è´¥é‡è¯•é€»è¾‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">return</span> ConsumeConcurrentlyStatus.RECONSUME_LATER;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ”’-å››ã€å®‰å…¨ç›¸å…³ï¼ˆACLï¼‰"><a href="#ğŸ”’-å››ã€å®‰å…¨ç›¸å…³ï¼ˆACLï¼‰" class="headerlink" title="ğŸ”’ å››ã€å®‰å…¨ç›¸å…³ï¼ˆACLï¼‰"></a>ğŸ”’ å››ã€å®‰å…¨ç›¸å…³ï¼ˆACLï¼‰</h2><ul>
<li><p>ACL å¯ç”¨åï¼Œä¸€å®šè¦é…ç½® accessKey å’Œ secretKeyã€‚</p>
</li>
<li><p>å®¢æˆ·ç«¯è‹¥æœªé…ç½®ï¼Œ<strong>ç›´æ¥æŠ¥é”™ Code: 308 æ— æƒé™</strong>ã€‚</p>
</li>
</ul>
<hr>
<h2 id="äº”ã€æ¶ˆæ¯å±æ€§å’Œ-Key-çš„ä½¿ç”¨å»ºè®®"><a href="#äº”ã€æ¶ˆæ¯å±æ€§å’Œ-Key-çš„ä½¿ç”¨å»ºè®®" class="headerlink" title="äº”ã€æ¶ˆæ¯å±æ€§å’Œ Key çš„ä½¿ç”¨å»ºè®®"></a>äº”ã€æ¶ˆæ¯å±æ€§å’Œ Key çš„ä½¿ç”¨å»ºè®®</h2><table>
<thead>
<tr>
<th>å±æ€§</th>
<th>å»ºè®®</th>
</tr>
</thead>
<tbody><tr>
<td><code>key</code></td>
<td>æ¯æ¡æ¶ˆæ¯éƒ½å»ºè®®è®¾ç½®ä¸šåŠ¡å”¯ä¸€ keyï¼Œä¾¿äºæŸ¥è¯¢å’Œå›æŸ¥äº‹åŠ¡ã€‚</td>
</tr>
<tr>
<td><code>tag</code></td>
<td>ç”¨äºæ¶ˆæ¯è¿‡æ»¤ï¼Œå»ºè®®æšä¸¾çº¦å®šåŒ–ç®¡ç†ï¼ˆé¿å…ä¹±å‘½åï¼‰</td>
</tr>
<tr>
<td><code>userProperty</code></td>
<td>å¯è‡ªå®šä¹‰ä¸šåŠ¡å±æ€§ï¼Œä¾›æ¶ˆè´¹è€…è¿‡æ»¤ç”¨ã€‚</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸ§ª-å…­ã€RocketMQTemplate-Spring-å°è£…æ³¨æ„äº‹é¡¹"><a href="#ğŸ§ª-å…­ã€RocketMQTemplate-Spring-å°è£…æ³¨æ„äº‹é¡¹" class="headerlink" title="ğŸ§ª å…­ã€RocketMQTemplate&#x2F;Spring å°è£…æ³¨æ„äº‹é¡¹"></a>ğŸ§ª å…­ã€RocketMQTemplate&#x2F;Spring å°è£…æ³¨æ„äº‹é¡¹</h2><ul>
<li><p><code>RocketMQTemplate</code> <strong>ä¸æ”¯æŒæ‰¹é‡æ¶ˆæ¯å‘é€</strong>ï¼Œå¦‚éœ€æ‰¹é‡è¯·è‡ªè¡Œæ‹†åŒ…æˆ–ä½¿ç”¨åŸç”Ÿ APIã€‚</p>
</li>
<li><p>ä½¿ç”¨ <code>@RocketMQMessageListener</code> æ—¶ä¸è¦æŠŠ <code>consumerGroup</code> é‡å¤æ³¨å†Œã€‚</p>
</li>
<li><p>åœ¨ Spring Boot åº”ç”¨ä¸­ï¼Œ<code>RocketMQTemplate</code> æ˜¯å•ä¾‹ beanï¼Œ<strong>ä¸è¦é‡å¤åˆ›å»º</strong>ã€‚</p>
</li>
</ul>
<hr>
<h2 id="ğŸ§¯-ä¸ƒã€æ€§èƒ½-å¯é æ€§ä¼˜åŒ–å»ºè®®"><a href="#ğŸ§¯-ä¸ƒã€æ€§èƒ½-å¯é æ€§ä¼˜åŒ–å»ºè®®" class="headerlink" title="ğŸ§¯ ä¸ƒã€æ€§èƒ½ &amp; å¯é æ€§ä¼˜åŒ–å»ºè®®"></a>ğŸ§¯ ä¸ƒã€æ€§èƒ½ &amp; å¯é æ€§ä¼˜åŒ–å»ºè®®</h2><table>
<thead>
<tr>
<th>ä¼˜åŒ–é¡¹</th>
<th>å»ºè®®</th>
</tr>
</thead>
<tbody><tr>
<td>æ‰¹é‡å‘é€</td>
<td>æ‹†åˆ†æ‰¹é‡åŒ… â‰¤ 4MBï¼Œæå‡åå</td>
</tr>
<tr>
<td>å‹ç¼©æ¶ˆæ¯</td>
<td><code>producer.setCompressMsgBodyOverHowmuch(1024)</code></td>
</tr>
<tr>
<td>æ¶ˆæ¯è¿½è¸ª</td>
<td>æ‰“å¼€ <code>enableMsgTrace</code> ä¾¿äºé—®é¢˜æ’æŸ¥</td>
</tr>
<tr>
<td>å¼‚å¸¸é‡è¯•</td>
<td>å¼‚å¸¸é‡è¯•æ¬¡æ•°å’Œé—´éš”åº”è§†ä¸šåŠ¡æƒ…å†µè®¾å®š</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸ¯-å…«ã€æ¨èé…ç½®æ¨¡æ¿ï¼ˆJava-åŸç”Ÿï¼‰"><a href="#ğŸ¯-å…«ã€æ¨èé…ç½®æ¨¡æ¿ï¼ˆJava-åŸç”Ÿï¼‰" class="headerlink" title="ğŸ¯ å…«ã€æ¨èé…ç½®æ¨¡æ¿ï¼ˆJava åŸç”Ÿï¼‰"></a>ğŸ¯ å…«ã€æ¨èé…ç½®æ¨¡æ¿ï¼ˆJava åŸç”Ÿï¼‰</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">DefaultMQProducer</span> <span class="hljs-variable">producer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultMQProducer</span>(<span class="hljs-string">&quot;your-producer-group&quot;</span>);<br>producer.setNamesrvAddr(<span class="hljs-string">&quot;127.0.0.1:9876;127.0.0.2:9876&quot;</span>);<br>producer.setRetryTimesWhenSendFailed(<span class="hljs-number">3</span>);<br>producer.setSendMsgTimeout(<span class="hljs-number">3000</span>);<br>producer.setCompressMsgBodyOverHowmuch(<span class="hljs-number">1024</span>);<br>producer.start();<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ-Bonusï¼šè¸©å‘åˆé›†ï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰"><a href="#ğŸ-Bonusï¼šè¸©å‘åˆé›†ï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰" class="headerlink" title="ğŸ Bonusï¼šè¸©å‘åˆé›†ï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰"></a>ğŸ Bonusï¼šè¸©å‘åˆé›†ï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰</h2><table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>é—®é¢˜</th>
<th>è§£å†³</th>
</tr>
</thead>
<tbody><tr>
<td>æ¶ˆè´¹ä¸€ç›´å¤±è´¥</td>
<td>æ¶ˆæ¯é‡è¯•æ­»å¾ªç¯</td>
<td>é…ç½®æœ€å¤§é‡è¯•æ¬¡æ•° + æ­»ä¿¡é˜Ÿåˆ—ç›‘å¬</td>
</tr>
<tr>
<td>å¤šä¸ªæœåŠ¡ç”¨åŒä¸€ä¸ª group</td>
<td>æ¶ˆè´¹è¢«æŠ¢å ï¼Œåªæ¶ˆè´¹ä¸€ä»½</td>
<td>æ¯ä¸ªæ¶ˆè´¹è€…å¾®æœåŠ¡ä½¿ç”¨ç‹¬ç«‹ group</td>
</tr>
<tr>
<td>æ¶ˆæ¯æ¶ˆè´¹è¿‡æ…¢</td>
<td>æ¶ˆè´¹çº¿ç¨‹æ•°é»˜è®¤ä½</td>
<td>é…ç½® consumeThreadMin&#x2F;Max</td>
</tr>
<tr>
<td>å¼‚æ­¥å‘é€æ²¡å›è°ƒ</td>
<td>è¢« GC æˆ–çº¿ç¨‹æ± æ”¶æ‰</td>
<td>ç”¨ CountDownLatch ç­‰æ–¹å¼ç­‰å›è°ƒ</td>
</tr>
</tbody></table>

      </section>
      <section class="extra">
        
          <ul class="copyright">
  
    <li><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>å•çº¿ç¨‹åƒåœ¾æ¸…ç†å·¥</li>
    <li><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://rongxiaohan.github.io/2025/06/02/RocketMQ%E8%BF%9B%E9%98%B6%E4%BA%8C/index.html" title="https:&#x2F;&#x2F;rongxiaohan.github.io&#x2F;2025&#x2F;06&#x2F;02&#x2F;RocketMQ%E8%BF%9B%E9%98%B6%E4%BA%8C&#x2F;index.html">https:&#x2F;&#x2F;rongxiaohan.github.io&#x2F;2025&#x2F;06&#x2F;02&#x2F;RocketMQ%E8%BF%9B%E9%98%B6%E4%BA%8C&#x2F;index.html</a></li>
    <li><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« å‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" title="BY-NC-SA" target="_blank" rel="noopener">BY-NC-SA</a> è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li>
  
</ul>
        
        
        
  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/RocketMQ/" rel="tag">RocketMQ</a></li></ul> 

        
  <nav class="nav">
    <a href="/2025/06/07/java%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/"><i class="iconfont iconleft"></i>Javaç±»åŠ è½½æœºåˆ¶</a>
    <a href="/2024/06/06/RocketMQ%20%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E6%A2%B3%E7%90%86/">RocketMQ å¸¸è§é—®é¢˜æ¢³ç†<i class="iconfont iconright"></i></a>
  </nav>

      </section>
      
    </section>
  </div>
</article></div>
      <div class="col-xl-3">
        
          
  <aside class="toc-wrap">
    <h3 class="toc-title">æ–‡ç« ç›®å½•ï¼š</h3>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RocketMQ%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF%E4%B8%8E%E6%89%B9%E9%87%8F%E6%B6%88%E6%81%AF"><span class="toc-text">RocketMQå»¶è¿Ÿæ¶ˆæ¯ä¸æ‰¹é‡æ¶ˆæ¯</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%95%92-%E4%B8%80%E3%80%81%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF%EF%BC%88%E5%AE%9A%E6%97%B6%E6%B6%88%E6%81%AF%EF%BC%89"><span class="toc-text">ğŸ•’ ä¸€ã€å»¶è¿Ÿæ¶ˆæ¯ï¼ˆå®šæ—¶æ¶ˆæ¯ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%9A%80-%E5%BB%B6%E8%BF%9F%E7%AD%89%E7%BA%A7%EF%BC%88%E9%BB%98%E8%AE%A4%EF%BC%89"><span class="toc-text">ğŸš€ å»¶è¿Ÿç­‰çº§ï¼ˆé»˜è®¤ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E7%82%B9"><span class="toc-text">ç‰¹ç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%8D-%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-text">âœ ç¤ºä¾‹ä»£ç </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%89%B9%E9%87%8F%E6%B6%88%E6%81%AF%EF%BC%88Batch-Message%EF%BC%89"><span class="toc-text">äºŒã€æ‰¹é‡æ¶ˆæ¯ï¼ˆBatch Messageï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-1"><span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%9A%AB-%E9%99%90%E5%88%B6"><span class="toc-text">ğŸš« é™åˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%8D-%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-1"><span class="toc-text">âœ ç¤ºä¾‹ä»£ç </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A4%94-%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF-vs-%E6%89%B9%E9%87%8F%E6%B6%88%E6%81%AF"><span class="toc-text">ğŸ¤” å»¶è¿Ÿæ¶ˆæ¯ vs æ‰¹é‡æ¶ˆæ¯</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RocketMQ%E4%BA%8B%E5%8A%A1%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6"><span class="toc-text">RocketMQäº‹åŠ¡æ¶ˆæ¯æœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BA%8B%E5%8A%A1%E6%B6%88%E6%81%AF%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86"><span class="toc-text">ä¸€ã€äº‹åŠ¡æ¶ˆæ¯æ ¸å¿ƒåŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%B8%8F%E2%83%A3-%E5%8D%8A%E6%B6%88%E6%81%AF%EF%BC%88Half-Message%EF%BC%89"><span class="toc-text">1ï¸âƒ£ åŠæ¶ˆæ¯ï¼ˆHalf Messageï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%B8%8F%E2%83%A3-%E6%89%A7%E8%A1%8C%E6%9C%AC%E5%9C%B0%E4%BA%8B%E5%8A%A1"><span class="toc-text">2ï¸âƒ£ æ‰§è¡Œæœ¬åœ°äº‹åŠ¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%B8%8F%E2%83%A3-%E6%A0%B9%E6%8D%AE%E6%9C%AC%E5%9C%B0%E4%BA%8B%E5%8A%A1%E7%BB%93%E6%9E%9C%E5%91%8A%E7%9F%A5-MQ%EF%BC%9A"><span class="toc-text">3ï¸âƒ£ æ ¹æ®æœ¬åœ°äº‹åŠ¡ç»“æœå‘ŠçŸ¥ MQï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81RocketMQ-%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%8A%B6%E6%80%81%E5%9B%9E%E6%9F%A5%E6%9C%BA%E5%88%B6"><span class="toc-text">äºŒã€RocketMQ çš„äº‹åŠ¡çŠ¶æ€å›æŸ¥æœºåˆ¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8F%97%EF%B8%8F-%E4%B8%89%E3%80%81%E5%85%B3%E9%94%AE%E7%B1%BB-%E6%96%B9%E6%B3%95"><span class="toc-text">ğŸ—ï¸ ä¸‰ã€å…³é”®ç±» &amp; æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B"><span class="toc-text">å››ã€å®Œæ•´ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E4%BA%8B%E5%8A%A1%E7%8A%B6%E6%80%81%E6%9E%9A%E4%B8%BE%E8%AF%B4%E6%98%8E"><span class="toc-text">äº”ã€äº‹åŠ¡çŠ¶æ€æšä¸¾è¯´æ˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%A7-%E5%85%AD%E3%80%81%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">ğŸš§ å…­ã€æ³¨æ„äº‹é¡¹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RocketMQ-ACL%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E4%BD%93%E7%B3%BB"><span class="toc-text">RocketMQ ACLæƒé™æ§åˆ¶ä½“ç³»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%90-%E4%B8%80%E3%80%81ACL-%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E6%A6%82%E8%A7%88"><span class="toc-text">ğŸ” ä¸€ã€ACL æƒé™æ§åˆ¶æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6%E7%BB%84%E6%88%90"><span class="toc-text">äºŒã€æ ¸å¿ƒæœºåˆ¶ç»„æˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%B8%8F%E2%83%A3-%E9%89%B4%E6%9D%83%E6%96%B9%E5%BC%8F%EF%BC%9AAccessKey-SecretKey"><span class="toc-text">1ï¸âƒ£ é‰´æƒæ–¹å¼ï¼šAccessKey &amp; SecretKey</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%B8%8F%E2%83%A3-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%9Aplain-acl-yml"><span class="toc-text">2ï¸âƒ£ é…ç½®æ–‡ä»¶ï¼šplain_acl.yml</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E7%B2%92%E5%BA%A6"><span class="toc-text">ä¸‰ã€æƒé™æ§åˆ¶ç²’åº¦</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%A7-%E5%9B%9B%E3%80%81%E5%BC%80%E5%90%AF-ACL-%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="toc-text">ğŸ”§ å››ã€å¼€å¯ ACL çš„æ­¥éª¤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%91%A8%E2%80%8D%F0%9F%92%BB-%E4%BA%94%E3%80%81%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8E%A5%E5%85%A5%E9%85%8D%E7%BD%AE%EF%BC%88Java-%E7%A4%BA%E4%BE%8B%EF%BC%89"><span class="toc-text">ğŸ‘¨â€ğŸ’» äº”ã€å®¢æˆ·ç«¯æ¥å…¥é…ç½®ï¼ˆJava ç¤ºä¾‹ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AA-%E5%85%AD%E3%80%81%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">ğŸ§ª å…­ã€æ³¨æ„äº‹é¡¹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot%E6%95%B4%E5%90%88RocketMQ"><span class="toc-text">SpringBootæ•´åˆRocketMQ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96%EF%BC%88%E4%BB%A5-Apache-%E5%AE%98%E6%96%B9%E7%89%88%E6%9C%AC%E4%B8%BA%E5%87%86%EF%BC%89"><span class="toc-text">ä¸€ã€å¼•å…¥ä¾èµ–ï¼ˆä»¥ Apache å®˜æ–¹ç‰ˆæœ¬ä¸ºå‡†ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E9%85%8D%E7%BD%AE-application-yml"><span class="toc-text">äºŒã€é…ç½® application.yml</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%80-%E4%B8%89%E3%80%81%E6%B6%88%E6%81%AF%E7%94%9F%E4%BA%A7%E8%80%85%E7%A4%BA%E4%BE%8B"><span class="toc-text">ğŸš€ ä¸‰ã€æ¶ˆæ¯ç”Ÿäº§è€…ç¤ºä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81"><span class="toc-text">æ™®é€šæ¶ˆæ¯å‘é€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6-Tag-%E5%92%8C-Key"><span class="toc-text">å¸¦ Tag å’Œ Key</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%A5-%E5%9B%9B%E3%80%81%E6%B6%88%E6%81%AF%E6%B6%88%E8%B4%B9%E8%80%85%E7%A4%BA%E4%BE%8B"><span class="toc-text">ğŸ“¥ å››ã€æ¶ˆæ¯æ¶ˆè´¹è€…ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E4%BA%8B%E5%8A%A1%E6%B6%88%E6%81%AF%EF%BC%88%E4%BA%8B%E5%8A%A1%E5%9E%8B-Producer%EF%BC%89"><span class="toc-text">äº”ã€äº‹åŠ¡æ¶ˆæ¯ï¼ˆäº‹åŠ¡å‹ Producerï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-text">äº‹åŠ¡ç›‘å¬å™¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9B%A1%EF%B8%8F-%E5%85%AD%E3%80%81%E5%BC%80%E5%90%AF-ACL-%E7%9A%84%E8%AF%9D%EF%BC%88%E9%9C%80%E8%A6%81%E8%AE%BE%E7%BD%AE%E5%87%AD%E8%AF%81%EF%BC%89"><span class="toc-text">ğŸ›¡ï¸ å…­ã€å¼€å¯ ACL çš„è¯ï¼ˆéœ€è¦è®¾ç½®å‡­è¯ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%8D-%E4%B8%83%E3%80%81%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="toc-text">ğŸ” ä¸ƒã€å¸¸è§é—®é¢˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8E%81-Bonus%EF%BC%9A%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E5%BB%BA%E8%AE%AE"><span class="toc-text">ğŸ Bonusï¼šæœ€ä½³å®è·µå»ºè®®</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RocketMQ%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">RocketMQå®¢æˆ·ç«¯æ³¨æ„äº‹é¡¹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%80%9A%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">ä¸€ã€å®¢æˆ·ç«¯é€šç”¨æ³¨æ„äº‹é¡¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%80-%E4%BA%8C%E3%80%81Producer-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">ğŸš€ äºŒã€Producer æ³¨æ„äº‹é¡¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E7%A1%AE%E9%85%8D%E7%BD%AE%E5%8F%91%E9%80%81%E9%87%8D%E8%AF%95%E6%9C%BA%E5%88%B6"><span class="toc-text">æ­£ç¡®é…ç½®å‘é€é‡è¯•æœºåˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%9D%E8%AF%81-Producer-%E9%95%BF%E6%97%B6%E9%97%B4%E5%AD%98%E5%9C%A8%EF%BC%88%E4%B8%8D%E8%83%BD%E9%A2%91%E7%B9%81%E5%88%9B%E5%BB%BA%E5%92%8C%E9%94%80%E6%AF%81%EF%BC%89"><span class="toc-text">ä¿è¯ Producer é•¿æ—¶é—´å­˜åœ¨ï¼ˆä¸èƒ½é¢‘ç¹åˆ›å»ºå’Œé”€æ¯ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%E5%89%8D%E4%B8%80%E5%AE%9A%E8%A6%81-start"><span class="toc-text">å‘é€æ¶ˆæ¯å‰ä¸€å®šè¦ start</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E6%B6%88%E6%81%AF%E4%B8%8D%E8%A6%81%E5%90%9E%E6%8E%89%E5%BC%82%E5%B8%B8"><span class="toc-text">å¼‚æ­¥æ¶ˆæ¯ä¸è¦åæ‰å¼‚å¸¸</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%A5-%E4%B8%89%E3%80%81Consumer-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">ğŸ“¥ ä¸‰ã€Consumer æ³¨æ„äº‹é¡¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%82%E7%AD%89%E6%B6%88%E8%B4%B9%EF%BC%81"><span class="toc-text">å¹‚ç­‰æ¶ˆè´¹ï¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%8F%82%E6%95%B0"><span class="toc-text">è®¾ç½®çº¿ç¨‹æ± å‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E8%B4%B9%E6%A8%A1%E5%BC%8F%E9%80%89%E6%8B%A9%EF%BC%9A%E9%9B%86%E7%BE%A4-vs-%E5%B9%BF%E6%92%AD"><span class="toc-text">æ¶ˆè´¹æ¨¡å¼é€‰æ‹©ï¼šé›†ç¾¤ vs å¹¿æ’­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8-ACK-%E5%A4%B1%E8%B4%A5%E9%87%8D%E8%AF%95%E9%80%BB%E8%BE%91"><span class="toc-text">æ‰‹åŠ¨ ACK å¤±è´¥é‡è¯•é€»è¾‘</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%92-%E5%9B%9B%E3%80%81%E5%AE%89%E5%85%A8%E7%9B%B8%E5%85%B3%EF%BC%88ACL%EF%BC%89"><span class="toc-text">ğŸ”’ å››ã€å®‰å…¨ç›¸å…³ï¼ˆACLï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%B6%88%E6%81%AF%E5%B1%9E%E6%80%A7%E5%92%8C-Key-%E7%9A%84%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="toc-text">äº”ã€æ¶ˆæ¯å±æ€§å’Œ Key çš„ä½¿ç”¨å»ºè®®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AA-%E5%85%AD%E3%80%81RocketMQTemplate-Spring-%E5%B0%81%E8%A3%85%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">ğŸ§ª å…­ã€RocketMQTemplate&#x2F;Spring å°è£…æ³¨æ„äº‹é¡¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AF-%E4%B8%83%E3%80%81%E6%80%A7%E8%83%BD-%E5%8F%AF%E9%9D%A0%E6%80%A7%E4%BC%98%E5%8C%96%E5%BB%BA%E8%AE%AE"><span class="toc-text">ğŸ§¯ ä¸ƒã€æ€§èƒ½ &amp; å¯é æ€§ä¼˜åŒ–å»ºè®®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8E%AF-%E5%85%AB%E3%80%81%E6%8E%A8%E8%8D%90%E9%85%8D%E7%BD%AE%E6%A8%A1%E6%9D%BF%EF%BC%88Java-%E5%8E%9F%E7%94%9F%EF%BC%89"><span class="toc-text">ğŸ¯ å…«ã€æ¨èé…ç½®æ¨¡æ¿ï¼ˆJava åŸç”Ÿï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8E%81-Bonus%EF%BC%9A%E8%B8%A9%E5%9D%91%E5%90%88%E9%9B%86%EF%BC%88%E7%9C%9F%E5%AE%9E%E6%A1%88%E4%BE%8B%EF%BC%89"><span class="toc-text">ğŸ Bonusï¼šè¸©å‘åˆé›†ï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰</span></a></li></ol></li></ol>
  </aside>

        
      </div>
    </div>
  </div>
</main>
  

<footer class="footer">
  <div class="footer-social"></div>
  
    <div class="footer-copyright"><p></p></div>
  
</footer>
  
      <div class="fab fab-plus">
    <i class="iconfont iconplus"></i>
  </div>
  
  
  
  <div class="fab fab-up">
    <i class="iconfont iconcaret-up"></i>
  </div>
  
  
    <div class="scrollbar j-scrollbar">
  <div class="scrollbar-current j-scrollbar-current"></div>
</div>
  
  
    
<script src="/js/color-mode.js"></script>

  
  
</body>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>





  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>




  
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>






  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js"></script>




<script src="/js/utils.js"></script>
<script src="/js/script.js"></script>







  <script>
    (function () {
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>












</html>